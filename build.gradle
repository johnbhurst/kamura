
buildscript {
  apply {
    apply from: 'http://skepticalhumorist.co.nz/artifactory/jfrog-gradle/org/jfrog/buildinfo/build-info-extractor-gradle/1.0.1/artifactoryplugin-1.0.1.gradle'
  }
  repositories {
    mavenRepo urls: "http://gradle.artifactoryonline.com/gradle/plugins"
  }
  dependencies {
    classpath "org.gradle.plugins:gradle-idea-plugin:0.2"
  }
}

apply plugin: "groovy"
apply plugin: "maven"
apply plugin: "org.gradle.idea"

group = "nz.co.skepticalhumorist"
version = "00.00.07"
status = 'release'

repositories {
  mavenCentral name: "jpdfunit-repo", urls: "http://jpdfunit.sourceforge.net/repo"
}

dependencies {
  groovy group: "org.codehaus.groovy", name: "groovy", version: "1.7.3"
  compile group: "com.lowagie", name: "itext", version: "2.1.7"
  testCompile group: "junit", name: "junit", version: "4.8.1"
  testCompile group: "net.sf.jpdfunit", name: "jpdfunit", version: "1.1"
  testRuntime group: "pdfbox", name: "pdfbox", version: "0.7.3"
}

uploadDefault {
  uploadDescriptor = true
  repositories {
    add(Class.forName("org.apache.ivy.plugins.resolver.FileSystemResolver").newInstance()) {
      name = 'repo'
      addIvyPattern "$projectDir/repo/[organisation]/[module]/[revision]/ivy.xml"
      addArtifactPattern "$projectDir/repo/[organisation]/[module]/[revision]/[type]s/[artifact].[ext]"
      checkmodified = true
    }
  }
}

void runExamples(String path) {
  new File("build/$path").mkdirs()
  def gse = new GroovyScriptEngine([path] as String[])
  new File(path).eachFileMatch(~/^.*\.groovy$/) {File file ->
    gse.run(file.name, new Binding())
  }
}

task runExamples << {
  runExamples("examples/classroom/intro")
}
